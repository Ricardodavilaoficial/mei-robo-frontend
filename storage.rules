rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {

    // -----------------------------
    // CONTATOS: arquivos no sandbox
    // Caminho: sandbox/{uid}/contatos/{contatoId}/{fileName}
    // Regra: só o dono logado pode ler/gravar
    // -----------------------------
    match /sandbox/{uid}/contatos/{contatoId}/{fileName=**} {
      allow read, write: if request.auth != null
                         && request.auth.uid == uid;
    }

    // Bloqueia todo o resto por padrão
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
